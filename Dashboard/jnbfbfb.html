<!DOCTYPE HTML>
<html>
<head>
<script>
window.onload = function() {

var dataPoints = [];

var chart = new CanvasJS.Chart("chartContainer", {
	theme: "light2",
	title: {
		text: "Live Data"
	},
	data: [{
		type: "line",
		dataPoints: dataPoints
	}]
});
updateData();

// Initial Values
var xValue = 0;
var yValue = 10;
var newDataCount = 6;

function addData(data) {
	if(newDataCount != 1) {
		$.each(data, function(key, value) {
			dataPoints.push({x: value[0], y: parseInt(value[1])});
			xValue++;
			yValue = parseInt(value[1]);
		});
	} else {
		//dataPoints.shift();
		dataPoints.push({x: data[0][0], y: parseInt(data[0][1])});
		xValue++;
		yValue = parseInt(data[0][1]);
	}
	
	newDataCount = 1;
	chart.render();
	setTimeout(updateData, 1500);
}

function updateData() {
	$.getJSON("https://canvasjs.com/services/data/datapoints.php?xstart="+xValue+"&ystart="+yValue+"&length="+newDataCount+"type=json", addData);
}

}
</script>
<style>  .progress-data {
    display: flex;
    justify-content: center;
    align-items: center;
    margin: 20px;
}

.progress-dial {
    width: 300px;
    height: 155px;
    margin: 0 10px;
}

.progress-dial .progressbar-text {
    color: #333;
    font-family: 'Figtree', sans-serif;
    font-size: 32px;
    font-weight: 700;
    line-height: normal;
    text-align: center;
    display: flex;
    flex-direction: column;
    flex-wrap: wrap;
    align-items: center;
    justify-content: center;
    gap: 6px 0;
}

.marks-line {
    width: 100%;
    height: 2px;
    background-color: #DF6E12;
}
</style>
</head>
<body>
<div id="chartContainer" style="height: 300px; width: 100%;"></div>
<script src="https://canvasjs.com/assets/script/jquery-1.11.1.min.js"></script>
<script src="https://cdn.canvasjs.com/jquery.canvasjs.min.js"></script>
<form action="" method="POST">
    <div class="progress-data">
        <div class="progress-dial" id="progressDial1" data-value="40">
            <div class="progressbar-text">
                <input type="text" name="dial1_value" value="40" hidden>
                <span id="text1">40 Â°C</span>
            </div>
        </div>
    </div>

    <div class="progress-data">
        <div class="progress-dial" id="progressDial2" data-value="60">
            <div class="progressbar-text">
                <input type="text" name="dial2_value" value="60" hidden>
                <span id="text2">60 %</span>
            </div>
        </div>
    </div>

    <div class="progress-data">
        <div class="progress-dial" id="progressDial3" data-value="80">
            <div class="progressbar-text">
                <input type="text" name="dial3_value" value="80" hidden>
                <span id="text3">80 ppm</span>
            </div>
        </div>
    </div>

    <div class="progress-data">
        <div class="progress-dial" id="progressDial4" data-value="90">
            <div class="progressbar-text">
                <input type="text" name="dial4_value" value="90" hidden>
                <span id="text4">90 ppm</span>
            </div>
        </div>
    </div>

</form>

<script src="https://cdn.jsdelivr.net/npm/progressbar.js"></script>
<script>
    function createProgressBar(dialId, dataValue, displayText) {
        var progressDial = document.getElementById(dialId);
        var targetValue = parseInt(dataValue) / 100;

        var bar = new ProgressBar.SemiCircle(progressDial, {
            strokeWidth: 11,
            color: '#DF6E12',
            trailColor: '#FDF2E9',
            trailWidth: 20,
            easing: 'easeInOut',
            duration: 1400,
            svgStyle: null,
            from: { color: '#DF6E12' },
            to: { color: '#DF6E12' },
            step: function (state, bar) {
                bar.path.setAttribute('stroke', state.color);
                var value = Math.round(bar.value() * 100);
                var textContent;

                textContent = `<span class="completed-text">${displayText}</span> <span class="ppm-text">${value}</span>`;

                bar.setText(textContent);
                bar.text.style.color = '#000';
            }
        });

        bar.animate(targetValue);
    }
    createProgressBar('progressDial1', 40, "Temperature");
        createProgressBar('progressDial2', 60, "Humidity");
        createProgressBar('progressDial3', 80, "CO2");
        createProgressBar('progressDial4', 90, "NH3");
    </script>
</body>
</html>